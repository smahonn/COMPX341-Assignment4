{"ast":null,"code":"var HTML5_MEDIA_EVENT;\n\n(function (HTML5_MEDIA_EVENT) {\n  HTML5_MEDIA_EVENT[\"PLAY\"] = \"play\";\n  HTML5_MEDIA_EVENT[\"PAUSE\"] = \"pause\";\n  HTML5_MEDIA_EVENT[\"ENDED\"] = \"Ended\";\n})(HTML5_MEDIA_EVENT || (HTML5_MEDIA_EVENT = {}));\n\nvar MEDIA_TYPE;\n\n(function (MEDIA_TYPE) {\n  MEDIA_TYPE[\"IFRAME\"] = \"IFRAME\";\n  MEDIA_TYPE[\"VIDEO\"] = \"VIDEO\";\n  MEDIA_TYPE[\"AUDIO\"] = \"AUDIO\";\n})(MEDIA_TYPE || (MEDIA_TYPE = {}));\n\nvar EVENT_TYPE;\n\n(function (EVENT_TYPE) {\n  EVENT_TYPE[\"PLAY\"] = \"Play\";\n  EVENT_TYPE[\"ENDED\"] = \"Ended\";\n  EVENT_TYPE[\"PAUSE\"] = \"Pause\";\n  EVENT_TYPE[\"TIME_WATCHED\"] = \"TimeWatched\";\n})(EVENT_TYPE || (EVENT_TYPE = {}));\n\nvar MediaAutoTrack =\n/** @class */\nfunction () {\n  function MediaAutoTrack(params, provider) {\n    var _a;\n\n    this.eventActionMapping = (_a = {}, _a[EVENT_TYPE.ENDED] = this.endedEventAction.bind(this), _a[EVENT_TYPE.PLAY] = this.playEventAction.bind(this), _a[EVENT_TYPE.PAUSE] = this.pauseEventAction.bind(this), _a);\n    var eventData = params.eventData;\n    this._params = params;\n    this._mediaElement = document.getElementById(eventData.properties['domElementId']);\n    this._started = false;\n    this._provider = provider;\n    var mediaTrackFunMapping = {\n      IFRAME: this._iframeMediaTracker,\n      VIDEO: this._html5MediaTracker,\n      AUDIO: this._html5MediaTracker\n    };\n\n    mediaTrackFunMapping[this._mediaElement.tagName].bind(this)();\n\n    this._initYoutubeFrame();\n  }\n\n  MediaAutoTrack.prototype._initYoutubeFrame = function () {\n    this._youTubeIframeLoader = {\n      src: 'https://www.youtube.com/iframe_api',\n      loading: false,\n      loaded: false,\n      listeners: [],\n      load: function load(callback) {\n        var _this = this;\n\n        this.listeners.push(callback);\n\n        if (this.loaded) {\n          setTimeout(function () {\n            _this.done();\n          });\n          return;\n        }\n\n        if (this.loading) {\n          return;\n        }\n\n        this.loading = true;\n\n        window['onYouTubeIframeAPIReady'] = function () {\n          _this.loaded = true;\n\n          _this.done();\n        };\n\n        var script = document.createElement('script');\n        script.type = 'text/javascript';\n        script.src = this.src;\n        document.body.appendChild(script);\n      },\n      done: function done() {\n        delete window['onYouTubeIframeAPIReady'];\n\n        while (this.listeners.length) {\n          this.listeners.pop()(window['YT']);\n        }\n      }\n    };\n  };\n\n  MediaAutoTrack.prototype._iframeMediaTracker = function () {\n    var that = this;\n    setInterval(function () {\n      if (that._started) {\n        that.recordEvent(MEDIA_TYPE.IFRAME, EVENT_TYPE.TIME_WATCHED);\n      }\n    }, 3 * 1000);\n\n    this._youTubeIframeLoader.load(function (YT) {\n      that._iframePlayer = new YT.Player(that._mediaElement.id, {\n        events: {\n          onStateChange: that._onPlayerStateChange.bind(that)\n        }\n      });\n    });\n  };\n\n  MediaAutoTrack.prototype._onPlayerStateChange = function (event) {\n    var iframeEventMapping = {\n      0: EVENT_TYPE.ENDED,\n      1: EVENT_TYPE.PLAY,\n      2: EVENT_TYPE.PAUSE\n    };\n    var eventType = iframeEventMapping[event.data];\n\n    if (eventType) {\n      this.eventActionMapping[eventType](MEDIA_TYPE.IFRAME);\n    }\n  };\n\n  MediaAutoTrack.prototype._html5MediaTracker = function () {\n    var that = this;\n    setInterval(function () {\n      if (that._started) {\n        that.recordEvent(MEDIA_TYPE.VIDEO, EVENT_TYPE.TIME_WATCHED);\n      }\n    }, 3 * 1000);\n\n    this._mediaElement.addEventListener(HTML5_MEDIA_EVENT.PLAY, function () {\n      that.eventActionMapping[EVENT_TYPE.PLAY](MEDIA_TYPE.VIDEO);\n    }, false);\n\n    this._mediaElement.addEventListener(HTML5_MEDIA_EVENT.PAUSE, function () {\n      that.eventActionMapping[EVENT_TYPE.PAUSE](MEDIA_TYPE.VIDEO);\n    }, false);\n\n    this._mediaElement.addEventListener(HTML5_MEDIA_EVENT.ENDED, function () {\n      that.eventActionMapping[EVENT_TYPE.ENDED](MEDIA_TYPE.VIDEO);\n    }, false);\n  };\n\n  MediaAutoTrack.prototype.playEventAction = function (mediaType) {\n    this._started = true;\n    this.recordEvent(mediaType, EVENT_TYPE.PLAY);\n  };\n\n  MediaAutoTrack.prototype.pauseEventAction = function (mediaType) {\n    this._started = false;\n    this.recordEvent(mediaType, EVENT_TYPE.PAUSE);\n  };\n\n  MediaAutoTrack.prototype.endedEventAction = function (mediaType) {\n    this._started = false;\n    this.recordEvent(mediaType, EVENT_TYPE.ENDED);\n  };\n\n  MediaAutoTrack.prototype.recordEvent = function (mediaType, eventType) {\n    var newParams = Object.assign({}, this._params);\n    var eventData = newParams.eventData;\n    eventData.eventType = eventType;\n\n    if (mediaType === MEDIA_TYPE.VIDEO) {\n      eventData.properties.timestamp = this._mediaElement.currentTime;\n      eventData.properties.duration = this._mediaElement.duration;\n    } else {\n      eventData.properties.timestamp = this._financial(this._iframePlayer.getCurrentTime());\n      eventData.properties.duration = this._financial(this._iframePlayer.getDuration());\n    }\n\n    var percentage = parseFloat(eventData.properties.timestamp) / parseFloat(eventData.properties.duration);\n    eventData.properties.eventValue = Number(percentage.toFixed(4));\n    delete eventData.properties.domElementId;\n\n    this._provider.putToBuffer(newParams);\n  };\n\n  MediaAutoTrack.prototype._financial = function (x) {\n    return Number.parseFloat(x).toFixed(4);\n  };\n\n  return MediaAutoTrack;\n}();\n\nexport { MediaAutoTrack };","map":{"version":3,"sources":["../../../src/Providers/AmazonPersonalizeHelper/MediaAutoTrack.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["var HTML5_MEDIA_EVENT;\r\n(function (HTML5_MEDIA_EVENT) {\r\n    HTML5_MEDIA_EVENT[\"PLAY\"] = \"play\";\r\n    HTML5_MEDIA_EVENT[\"PAUSE\"] = \"pause\";\r\n    HTML5_MEDIA_EVENT[\"ENDED\"] = \"Ended\";\r\n})(HTML5_MEDIA_EVENT || (HTML5_MEDIA_EVENT = {}));\r\nvar MEDIA_TYPE;\r\n(function (MEDIA_TYPE) {\r\n    MEDIA_TYPE[\"IFRAME\"] = \"IFRAME\";\r\n    MEDIA_TYPE[\"VIDEO\"] = \"VIDEO\";\r\n    MEDIA_TYPE[\"AUDIO\"] = \"AUDIO\";\r\n})(MEDIA_TYPE || (MEDIA_TYPE = {}));\r\nvar EVENT_TYPE;\r\n(function (EVENT_TYPE) {\r\n    EVENT_TYPE[\"PLAY\"] = \"Play\";\r\n    EVENT_TYPE[\"ENDED\"] = \"Ended\";\r\n    EVENT_TYPE[\"PAUSE\"] = \"Pause\";\r\n    EVENT_TYPE[\"TIME_WATCHED\"] = \"TimeWatched\";\r\n})(EVENT_TYPE || (EVENT_TYPE = {}));\r\nvar MediaAutoTrack = /** @class */ (function () {\r\n    function MediaAutoTrack(params, provider) {\r\n        var _a;\r\n        this.eventActionMapping = (_a = {},\r\n            _a[EVENT_TYPE.ENDED] = this.endedEventAction.bind(this),\r\n            _a[EVENT_TYPE.PLAY] = this.playEventAction.bind(this),\r\n            _a[EVENT_TYPE.PAUSE] = this.pauseEventAction.bind(this),\r\n            _a);\r\n        var eventData = params.eventData;\r\n        this._params = params;\r\n        this._mediaElement = document.getElementById(eventData.properties['domElementId']);\r\n        this._started = false;\r\n        this._provider = provider;\r\n        var mediaTrackFunMapping = {\r\n            IFRAME: this._iframeMediaTracker,\r\n            VIDEO: this._html5MediaTracker,\r\n            AUDIO: this._html5MediaTracker,\r\n        };\r\n        mediaTrackFunMapping[this._mediaElement.tagName].bind(this)();\r\n        this._initYoutubeFrame();\r\n    }\r\n    MediaAutoTrack.prototype._initYoutubeFrame = function () {\r\n        this._youTubeIframeLoader = {\r\n            src: 'https://www.youtube.com/iframe_api',\r\n            loading: false,\r\n            loaded: false,\r\n            listeners: [],\r\n            load: function (callback) {\r\n                var _this = this;\r\n                this.listeners.push(callback);\r\n                if (this.loaded) {\r\n                    setTimeout(function () {\r\n                        _this.done();\r\n                    });\r\n                    return;\r\n                }\r\n                if (this.loading) {\r\n                    return;\r\n                }\r\n                this.loading = true;\r\n                window['onYouTubeIframeAPIReady'] = function () {\r\n                    _this.loaded = true;\r\n                    _this.done();\r\n                };\r\n                var script = document.createElement('script');\r\n                script.type = 'text/javascript';\r\n                script.src = this.src;\r\n                document.body.appendChild(script);\r\n            },\r\n            done: function () {\r\n                delete window['onYouTubeIframeAPIReady'];\r\n                while (this.listeners.length) {\r\n                    this.listeners.pop()(window['YT']);\r\n                }\r\n            },\r\n        };\r\n    };\r\n    MediaAutoTrack.prototype._iframeMediaTracker = function () {\r\n        var that = this;\r\n        setInterval(function () {\r\n            if (that._started) {\r\n                that.recordEvent(MEDIA_TYPE.IFRAME, EVENT_TYPE.TIME_WATCHED);\r\n            }\r\n        }, 3 * 1000);\r\n        this._youTubeIframeLoader.load(function (YT) {\r\n            that._iframePlayer = new YT.Player(that._mediaElement.id, {\r\n                events: { onStateChange: that._onPlayerStateChange.bind(that) },\r\n            });\r\n        });\r\n    };\r\n    MediaAutoTrack.prototype._onPlayerStateChange = function (event) {\r\n        var iframeEventMapping = {\r\n            0: EVENT_TYPE.ENDED,\r\n            1: EVENT_TYPE.PLAY,\r\n            2: EVENT_TYPE.PAUSE,\r\n        };\r\n        var eventType = iframeEventMapping[event.data];\r\n        if (eventType) {\r\n            this.eventActionMapping[eventType](MEDIA_TYPE.IFRAME);\r\n        }\r\n    };\r\n    MediaAutoTrack.prototype._html5MediaTracker = function () {\r\n        var that = this;\r\n        setInterval(function () {\r\n            if (that._started) {\r\n                that.recordEvent(MEDIA_TYPE.VIDEO, EVENT_TYPE.TIME_WATCHED);\r\n            }\r\n        }, 3 * 1000);\r\n        this._mediaElement.addEventListener(HTML5_MEDIA_EVENT.PLAY, function () {\r\n            that.eventActionMapping[EVENT_TYPE.PLAY](MEDIA_TYPE.VIDEO);\r\n        }, false);\r\n        this._mediaElement.addEventListener(HTML5_MEDIA_EVENT.PAUSE, function () {\r\n            that.eventActionMapping[EVENT_TYPE.PAUSE](MEDIA_TYPE.VIDEO);\r\n        }, false);\r\n        this._mediaElement.addEventListener(HTML5_MEDIA_EVENT.ENDED, function () {\r\n            that.eventActionMapping[EVENT_TYPE.ENDED](MEDIA_TYPE.VIDEO);\r\n        }, false);\r\n    };\r\n    MediaAutoTrack.prototype.playEventAction = function (mediaType) {\r\n        this._started = true;\r\n        this.recordEvent(mediaType, EVENT_TYPE.PLAY);\r\n    };\r\n    MediaAutoTrack.prototype.pauseEventAction = function (mediaType) {\r\n        this._started = false;\r\n        this.recordEvent(mediaType, EVENT_TYPE.PAUSE);\r\n    };\r\n    MediaAutoTrack.prototype.endedEventAction = function (mediaType) {\r\n        this._started = false;\r\n        this.recordEvent(mediaType, EVENT_TYPE.ENDED);\r\n    };\r\n    MediaAutoTrack.prototype.recordEvent = function (mediaType, eventType) {\r\n        var newParams = Object.assign({}, this._params);\r\n        var eventData = newParams.eventData;\r\n        eventData.eventType = eventType;\r\n        if (mediaType === MEDIA_TYPE.VIDEO) {\r\n            eventData.properties.timestamp = this._mediaElement.currentTime;\r\n            eventData.properties.duration = this._mediaElement.duration;\r\n        }\r\n        else {\r\n            eventData.properties.timestamp = this._financial(this._iframePlayer.getCurrentTime());\r\n            eventData.properties.duration = this._financial(this._iframePlayer.getDuration());\r\n        }\r\n        var percentage = parseFloat(eventData.properties.timestamp) /\r\n            parseFloat(eventData.properties.duration);\r\n        eventData.properties.eventValue = Number(percentage.toFixed(4));\r\n        delete eventData.properties.domElementId;\r\n        this._provider.putToBuffer(newParams);\r\n    };\r\n    MediaAutoTrack.prototype._financial = function (x) {\r\n        return Number.parseFloat(x).toFixed(4);\r\n    };\r\n    return MediaAutoTrack;\r\n}());\r\nexport { MediaAutoTrack };\r\n//# sourceMappingURL=MediaAutoTrack.js.map"]},"metadata":{},"sourceType":"module"}