{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar LRU_1 = require(\"./utils/LRU\");\n\nvar CACHE_SIZE = 1000;\n/**\r\n * Inspired node-lru-cache[https://github.com/isaacs/node-lru-cache]\r\n */\n\nvar EndpointCache =\n/** @class */\nfunction () {\n  function EndpointCache(maxSize) {\n    if (maxSize === void 0) {\n      maxSize = CACHE_SIZE;\n    }\n\n    this.maxSize = maxSize;\n    this.cache = new LRU_1.LRUCache(maxSize);\n  }\n\n  ;\n  Object.defineProperty(EndpointCache.prototype, \"size\", {\n    get: function get() {\n      return this.cache.length;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  EndpointCache.prototype.put = function (key, value) {\n    var keyString = typeof key !== 'string' ? EndpointCache.getKeyString(key) : key;\n    var endpointRecord = this.populateValue(value);\n    this.cache.put(keyString, endpointRecord);\n  };\n\n  EndpointCache.prototype.get = function (key) {\n    var keyString = typeof key !== 'string' ? EndpointCache.getKeyString(key) : key;\n    var now = Date.now();\n    var records = this.cache.get(keyString);\n\n    if (records) {\n      for (var i = 0; i < records.length; i++) {\n        var record = records[i];\n\n        if (record.Expire < now) {\n          this.cache.remove(keyString);\n          return undefined;\n        }\n      }\n    }\n\n    return records;\n  };\n\n  EndpointCache.getKeyString = function (key) {\n    var identifiers = [];\n    var identifierNames = Object.keys(key).sort();\n\n    for (var i = 0; i < identifierNames.length; i++) {\n      var identifierName = identifierNames[i];\n      if (key[identifierName] === undefined) continue;\n      identifiers.push(key[identifierName]);\n    }\n\n    return identifiers.join(' ');\n  };\n\n  EndpointCache.prototype.populateValue = function (endpoints) {\n    var now = Date.now();\n    return endpoints.map(function (endpoint) {\n      return {\n        Address: endpoint.Address || '',\n        Expire: now + (endpoint.CachePeriodInMinutes || 1) * 60 * 1000\n      };\n    });\n  };\n\n  EndpointCache.prototype.empty = function () {\n    this.cache.empty();\n  };\n\n  EndpointCache.prototype.remove = function (key) {\n    var keyString = typeof key !== 'string' ? EndpointCache.getKeyString(key) : key;\n    this.cache.remove(keyString);\n  };\n\n  return EndpointCache;\n}();\n\nexports.EndpointCache = EndpointCache;","map":{"version":3,"sources":["C:/Users/Shutt/Documents/COMPX341/COMPX341-Assignment4/assets/node_modules/aws-sdk/vendor/endpoint-cache/index.js"],"names":["Object","defineProperty","exports","value","LRU_1","require","CACHE_SIZE","EndpointCache","maxSize","cache","LRUCache","prototype","get","length","enumerable","configurable","put","key","keyString","getKeyString","endpointRecord","populateValue","now","Date","records","i","record","Expire","remove","undefined","identifiers","identifierNames","keys","sort","identifierName","push","join","endpoints","map","endpoint","Address","CachePeriodInMinutes","empty"],"mappings":"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","sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar LRU_1 = require(\"./utils/LRU\");\r\nvar CACHE_SIZE = 1000;\r\n/**\r\n * Inspired node-lru-cache[https://github.com/isaacs/node-lru-cache]\r\n */\r\nvar EndpointCache = /** @class */ (function () {\r\n    function EndpointCache(maxSize) {\r\n        if (maxSize === void 0) { maxSize = CACHE_SIZE; }\r\n        this.maxSize = maxSize;\r\n        this.cache = new LRU_1.LRUCache(maxSize);\r\n    }\r\n    ;\r\n    Object.defineProperty(EndpointCache.prototype, \"size\", {\r\n        get: function () {\r\n            return this.cache.length;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    EndpointCache.prototype.put = function (key, value) {\r\n      var keyString = typeof key !== 'string' ? EndpointCache.getKeyString(key) : key;\r\n        var endpointRecord = this.populateValue(value);\r\n        this.cache.put(keyString, endpointRecord);\r\n    };\r\n    EndpointCache.prototype.get = function (key) {\r\n      var keyString = typeof key !== 'string' ? EndpointCache.getKeyString(key) : key;\r\n        var now = Date.now();\r\n        var records = this.cache.get(keyString);\r\n        if (records) {\r\n            for (var i = 0; i < records.length; i++) {\r\n                var record = records[i];\r\n                if (record.Expire < now) {\r\n                    this.cache.remove(keyString);\r\n                    return undefined;\r\n                }\r\n            }\r\n        }\r\n        return records;\r\n    };\r\n    EndpointCache.getKeyString = function (key) {\r\n        var identifiers = [];\r\n        var identifierNames = Object.keys(key).sort();\r\n        for (var i = 0; i < identifierNames.length; i++) {\r\n            var identifierName = identifierNames[i];\r\n            if (key[identifierName] === undefined)\r\n                continue;\r\n            identifiers.push(key[identifierName]);\r\n        }\r\n        return identifiers.join(' ');\r\n    };\r\n    EndpointCache.prototype.populateValue = function (endpoints) {\r\n        var now = Date.now();\r\n        return endpoints.map(function (endpoint) { return ({\r\n            Address: endpoint.Address || '',\r\n            Expire: now + (endpoint.CachePeriodInMinutes || 1) * 60 * 1000\r\n        }); });\r\n    };\r\n    EndpointCache.prototype.empty = function () {\r\n        this.cache.empty();\r\n    };\r\n    EndpointCache.prototype.remove = function (key) {\r\n      var keyString = typeof key !== 'string' ? EndpointCache.getKeyString(key) : key;\r\n        this.cache.remove(keyString);\r\n    };\r\n    return EndpointCache;\r\n}());\r\nexports.EndpointCache = EndpointCache;"]},"metadata":{},"sourceType":"script"}