{"ast":null,"code":"var Collection = require('./collection');\n\nvar util = require('../util');\n\nfunction property(obj, name, value) {\n  if (value !== null && value !== undefined) {\n    util.property.apply(this, arguments);\n  }\n}\n\nfunction memoizedProperty(obj, name) {\n  if (!obj.constructor.prototype[name]) {\n    util.memoizedProperty.apply(this, arguments);\n  }\n}\n\nfunction Shape(shape, options, memberName) {\n  options = options || {};\n  property(this, 'shape', shape.shape);\n  property(this, 'api', options.api, false);\n  property(this, 'type', shape.type);\n  property(this, 'enum', shape.enum);\n  property(this, 'min', shape.min);\n  property(this, 'max', shape.max);\n  property(this, 'pattern', shape.pattern);\n  property(this, 'location', shape.location || this.location || 'body');\n  property(this, 'name', this.name || shape.xmlName || shape.queryName || shape.locationName || memberName);\n  property(this, 'isStreaming', shape.streaming || this.isStreaming || false);\n  property(this, 'requiresLength', shape.requiresLength, false);\n  property(this, 'isComposite', shape.isComposite || false);\n  property(this, 'isShape', true, false);\n  property(this, 'isQueryName', Boolean(shape.queryName), false);\n  property(this, 'isLocationName', Boolean(shape.locationName), false);\n  property(this, 'isIdempotent', shape.idempotencyToken === true);\n  property(this, 'isJsonValue', shape.jsonvalue === true);\n  property(this, 'isSensitive', shape.sensitive === true || shape.prototype && shape.prototype.sensitive === true);\n  property(this, 'isEventStream', Boolean(shape.eventstream), false);\n  property(this, 'isEvent', Boolean(shape.event), false);\n  property(this, 'isEventPayload', Boolean(shape.eventpayload), false);\n  property(this, 'isEventHeader', Boolean(shape.eventheader), false);\n  property(this, 'isTimestampFormatSet', Boolean(shape.timestampFormat) || shape.prototype && shape.prototype.isTimestampFormatSet === true, false);\n  property(this, 'endpointDiscoveryId', Boolean(shape.endpointdiscoveryid), false);\n  property(this, 'hostLabel', Boolean(shape.hostLabel), false);\n\n  if (options.documentation) {\n    property(this, 'documentation', shape.documentation);\n    property(this, 'documentationUrl', shape.documentationUrl);\n  }\n\n  if (shape.xmlAttribute) {\n    property(this, 'isXmlAttribute', shape.xmlAttribute || false);\n  } // type conversion and parsing\n\n\n  property(this, 'defaultValue', null);\n\n  this.toWireFormat = function (value) {\n    if (value === null || value === undefined) return '';\n    return value;\n  };\n\n  this.toType = function (value) {\n    return value;\n  };\n}\n/**\r\n * @api private\r\n */\n\n\nShape.normalizedTypes = {\n  character: 'string',\n  double: 'float',\n  long: 'integer',\n  short: 'integer',\n  biginteger: 'integer',\n  bigdecimal: 'float',\n  blob: 'binary'\n};\n/**\r\n * @api private\r\n */\n\nShape.types = {\n  'structure': StructureShape,\n  'list': ListShape,\n  'map': MapShape,\n  'boolean': BooleanShape,\n  'timestamp': TimestampShape,\n  'float': FloatShape,\n  'integer': IntegerShape,\n  'string': StringShape,\n  'base64': Base64Shape,\n  'binary': BinaryShape\n};\n\nShape.resolve = function resolve(shape, options) {\n  if (shape.shape) {\n    var refShape = options.api.shapes[shape.shape];\n\n    if (!refShape) {\n      throw new Error('Cannot find shape reference: ' + shape.shape);\n    }\n\n    return refShape;\n  } else {\n    return null;\n  }\n};\n\nShape.create = function create(shape, options, memberName) {\n  if (shape.isShape) return shape;\n  var refShape = Shape.resolve(shape, options);\n\n  if (refShape) {\n    var filteredKeys = Object.keys(shape);\n\n    if (!options.documentation) {\n      filteredKeys = filteredKeys.filter(function (name) {\n        return !name.match(/documentation/);\n      });\n    } // create an inline shape with extra members\n\n\n    var InlineShape = function InlineShape() {\n      refShape.constructor.call(this, shape, options, memberName);\n    };\n\n    InlineShape.prototype = refShape;\n    return new InlineShape();\n  } else {\n    // set type if not set\n    if (!shape.type) {\n      if (shape.members) shape.type = 'structure';else if (shape.member) shape.type = 'list';else if (shape.key) shape.type = 'map';else shape.type = 'string';\n    } // normalize types\n\n\n    var origType = shape.type;\n\n    if (Shape.normalizedTypes[shape.type]) {\n      shape.type = Shape.normalizedTypes[shape.type];\n    }\n\n    if (Shape.types[shape.type]) {\n      return new Shape.types[shape.type](shape, options, memberName);\n    } else {\n      throw new Error('Unrecognized shape type: ' + origType);\n    }\n  }\n};\n\nfunction CompositeShape(shape) {\n  Shape.apply(this, arguments);\n  property(this, 'isComposite', true);\n\n  if (shape.flattened) {\n    property(this, 'flattened', shape.flattened || false);\n  }\n}\n\nfunction StructureShape(shape, options) {\n  var self = this;\n  var requiredMap = null,\n      firstInit = !this.isShape;\n  CompositeShape.apply(this, arguments);\n\n  if (firstInit) {\n    property(this, 'defaultValue', function () {\n      return {};\n    });\n    property(this, 'members', {});\n    property(this, 'memberNames', []);\n    property(this, 'required', []);\n    property(this, 'isRequired', function () {\n      return false;\n    });\n  }\n\n  if (shape.members) {\n    property(this, 'members', new Collection(shape.members, options, function (name, member) {\n      return Shape.create(member, options, name);\n    }));\n    memoizedProperty(this, 'memberNames', function () {\n      return shape.xmlOrder || Object.keys(shape.members);\n    });\n\n    if (shape.event) {\n      memoizedProperty(this, 'eventPayloadMemberName', function () {\n        var members = self.members;\n        var memberNames = self.memberNames; // iterate over members to find ones that are event payloads\n\n        for (var i = 0, iLen = memberNames.length; i < iLen; i++) {\n          if (members[memberNames[i]].isEventPayload) {\n            return memberNames[i];\n          }\n        }\n      });\n      memoizedProperty(this, 'eventHeaderMemberNames', function () {\n        var members = self.members;\n        var memberNames = self.memberNames;\n        var eventHeaderMemberNames = []; // iterate over members to find ones that are event headers\n\n        for (var i = 0, iLen = memberNames.length; i < iLen; i++) {\n          if (members[memberNames[i]].isEventHeader) {\n            eventHeaderMemberNames.push(memberNames[i]);\n          }\n        }\n\n        return eventHeaderMemberNames;\n      });\n    }\n  }\n\n  if (shape.required) {\n    property(this, 'required', shape.required);\n    property(this, 'isRequired', function (name) {\n      if (!requiredMap) {\n        requiredMap = {};\n\n        for (var i = 0; i < shape.required.length; i++) {\n          requiredMap[shape.required[i]] = true;\n        }\n      }\n\n      return requiredMap[name];\n    }, false, true);\n  }\n\n  property(this, 'resultWrapper', shape.resultWrapper || null);\n\n  if (shape.payload) {\n    property(this, 'payload', shape.payload);\n  }\n\n  if (typeof shape.xmlNamespace === 'string') {\n    property(this, 'xmlNamespaceUri', shape.xmlNamespace);\n  } else if (typeof shape.xmlNamespace === 'object') {\n    property(this, 'xmlNamespacePrefix', shape.xmlNamespace.prefix);\n    property(this, 'xmlNamespaceUri', shape.xmlNamespace.uri);\n  }\n}\n\nfunction ListShape(shape, options) {\n  var self = this,\n      firstInit = !this.isShape;\n  CompositeShape.apply(this, arguments);\n\n  if (firstInit) {\n    property(this, 'defaultValue', function () {\n      return [];\n    });\n  }\n\n  if (shape.member) {\n    memoizedProperty(this, 'member', function () {\n      return Shape.create(shape.member, options);\n    });\n  }\n\n  if (this.flattened) {\n    var oldName = this.name;\n    memoizedProperty(this, 'name', function () {\n      return self.member.name || oldName;\n    });\n  }\n}\n\nfunction MapShape(shape, options) {\n  var firstInit = !this.isShape;\n  CompositeShape.apply(this, arguments);\n\n  if (firstInit) {\n    property(this, 'defaultValue', function () {\n      return {};\n    });\n    property(this, 'key', Shape.create({\n      type: 'string'\n    }, options));\n    property(this, 'value', Shape.create({\n      type: 'string'\n    }, options));\n  }\n\n  if (shape.key) {\n    memoizedProperty(this, 'key', function () {\n      return Shape.create(shape.key, options);\n    });\n  }\n\n  if (shape.value) {\n    memoizedProperty(this, 'value', function () {\n      return Shape.create(shape.value, options);\n    });\n  }\n}\n\nfunction TimestampShape(shape) {\n  var self = this;\n  Shape.apply(this, arguments);\n\n  if (shape.timestampFormat) {\n    property(this, 'timestampFormat', shape.timestampFormat);\n  } else if (self.isTimestampFormatSet && this.timestampFormat) {\n    property(this, 'timestampFormat', this.timestampFormat);\n  } else if (this.location === 'header') {\n    property(this, 'timestampFormat', 'rfc822');\n  } else if (this.location === 'querystring') {\n    property(this, 'timestampFormat', 'iso8601');\n  } else if (this.api) {\n    switch (this.api.protocol) {\n      case 'json':\n      case 'rest-json':\n        property(this, 'timestampFormat', 'unixTimestamp');\n        break;\n\n      case 'rest-xml':\n      case 'query':\n      case 'ec2':\n        property(this, 'timestampFormat', 'iso8601');\n        break;\n    }\n  }\n\n  this.toType = function (value) {\n    if (value === null || value === undefined) return null;\n    if (typeof value.toUTCString === 'function') return value;\n    return typeof value === 'string' || typeof value === 'number' ? util.date.parseTimestamp(value) : null;\n  };\n\n  this.toWireFormat = function (value) {\n    return util.date.format(value, self.timestampFormat);\n  };\n}\n\nfunction StringShape() {\n  Shape.apply(this, arguments);\n  var nullLessProtocols = ['rest-xml', 'query', 'ec2'];\n\n  this.toType = function (value) {\n    value = this.api && nullLessProtocols.indexOf(this.api.protocol) > -1 ? value || '' : value;\n\n    if (this.isJsonValue) {\n      return JSON.parse(value);\n    }\n\n    return value && typeof value.toString === 'function' ? value.toString() : value;\n  };\n\n  this.toWireFormat = function (value) {\n    return this.isJsonValue ? JSON.stringify(value) : value;\n  };\n}\n\nfunction FloatShape() {\n  Shape.apply(this, arguments);\n\n  this.toType = function (value) {\n    if (value === null || value === undefined) return null;\n    return parseFloat(value);\n  };\n\n  this.toWireFormat = this.toType;\n}\n\nfunction IntegerShape() {\n  Shape.apply(this, arguments);\n\n  this.toType = function (value) {\n    if (value === null || value === undefined) return null;\n    return parseInt(value, 10);\n  };\n\n  this.toWireFormat = this.toType;\n}\n\nfunction BinaryShape() {\n  Shape.apply(this, arguments);\n\n  this.toType = function (value) {\n    var buf = util.base64.decode(value);\n\n    if (this.isSensitive && util.isNode() && typeof util.Buffer.alloc === 'function') {\n      /* Node.js can create a Buffer that is not isolated.\r\n       * i.e. buf.byteLength !== buf.buffer.byteLength\r\n       * This means that the sensitive data is accessible to anyone with access to buf.buffer.\r\n       * If this is the node shared Buffer, then other code within this process _could_ find this secret.\r\n       * Copy sensitive data to an isolated Buffer and zero the sensitive data.\r\n       * While this is safe to do here, copying this code somewhere else may produce unexpected results.\r\n       */\n      var secureBuf = util.Buffer.alloc(buf.length, buf);\n      buf.fill(0);\n      buf = secureBuf;\n    }\n\n    return buf;\n  };\n\n  this.toWireFormat = util.base64.encode;\n}\n\nfunction Base64Shape() {\n  BinaryShape.apply(this, arguments);\n}\n\nfunction BooleanShape() {\n  Shape.apply(this, arguments);\n\n  this.toType = function (value) {\n    if (typeof value === 'boolean') return value;\n    if (value === null || value === undefined) return null;\n    return value === 'true';\n  };\n}\n/**\r\n * @api private\r\n */\n\n\nShape.shapes = {\n  StructureShape: StructureShape,\n  ListShape: ListShape,\n  MapShape: MapShape,\n  StringShape: StringShape,\n  BooleanShape: BooleanShape,\n  Base64Shape: Base64Shape\n};\n/**\r\n * @api private\r\n */\n\nmodule.exports = Shape;","map":{"version":3,"sources":["C:/Users/Shutt/Documents/COMPX341/COMPX341-Assignment4/assets/node_modules/aws-sdk/lib/model/shape.js"],"names":["Collection","require","util","property","obj","name","value","undefined","apply","arguments","memoizedProperty","constructor","prototype","Shape","shape","options","memberName","api","type","enum","min","max","pattern","location","xmlName","queryName","locationName","streaming","isStreaming","requiresLength","isComposite","Boolean","idempotencyToken","jsonvalue","sensitive","eventstream","event","eventpayload","eventheader","timestampFormat","isTimestampFormatSet","endpointdiscoveryid","hostLabel","documentation","documentationUrl","xmlAttribute","toWireFormat","toType","normalizedTypes","character","double","long","short","biginteger","bigdecimal","blob","types","StructureShape","ListShape","MapShape","BooleanShape","TimestampShape","FloatShape","IntegerShape","StringShape","Base64Shape","BinaryShape","resolve","refShape","shapes","Error","create","isShape","filteredKeys","Object","keys","filter","match","InlineShape","call","members","member","key","origType","CompositeShape","flattened","self","requiredMap","firstInit","xmlOrder","memberNames","i","iLen","length","isEventPayload","eventHeaderMemberNames","isEventHeader","push","required","resultWrapper","payload","xmlNamespace","prefix","uri","oldName","protocol","toUTCString","date","parseTimestamp","format","nullLessProtocols","indexOf","isJsonValue","JSON","parse","toString","stringify","parseFloat","parseInt","buf","base64","decode","isSensitive","isNode","Buffer","alloc","secureBuf","fill","encode","module","exports"],"mappings":"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","sourcesContent":["var Collection = require('./collection');\r\n\r\nvar util = require('../util');\r\n\r\nfunction property(obj, name, value) {\r\n  if (value !== null && value !== undefined) {\r\n    util.property.apply(this, arguments);\r\n  }\r\n}\r\n\r\nfunction memoizedProperty(obj, name) {\r\n  if (!obj.constructor.prototype[name]) {\r\n    util.memoizedProperty.apply(this, arguments);\r\n  }\r\n}\r\n\r\nfunction Shape(shape, options, memberName) {\r\n  options = options || {};\r\n\r\n  property(this, 'shape', shape.shape);\r\n  property(this, 'api', options.api, false);\r\n  property(this, 'type', shape.type);\r\n  property(this, 'enum', shape.enum);\r\n  property(this, 'min', shape.min);\r\n  property(this, 'max', shape.max);\r\n  property(this, 'pattern', shape.pattern);\r\n  property(this, 'location', shape.location || this.location || 'body');\r\n  property(this, 'name', this.name || shape.xmlName || shape.queryName ||\r\n    shape.locationName || memberName);\r\n  property(this, 'isStreaming', shape.streaming || this.isStreaming || false);\r\n  property(this, 'requiresLength', shape.requiresLength, false);\r\n  property(this, 'isComposite', shape.isComposite || false);\r\n  property(this, 'isShape', true, false);\r\n  property(this, 'isQueryName', Boolean(shape.queryName), false);\r\n  property(this, 'isLocationName', Boolean(shape.locationName), false);\r\n  property(this, 'isIdempotent', shape.idempotencyToken === true);\r\n  property(this, 'isJsonValue', shape.jsonvalue === true);\r\n  property(this, 'isSensitive', shape.sensitive === true || shape.prototype && shape.prototype.sensitive === true);\r\n  property(this, 'isEventStream', Boolean(shape.eventstream), false);\r\n  property(this, 'isEvent', Boolean(shape.event), false);\r\n  property(this, 'isEventPayload', Boolean(shape.eventpayload), false);\r\n  property(this, 'isEventHeader', Boolean(shape.eventheader), false);\r\n  property(this, 'isTimestampFormatSet', Boolean(shape.timestampFormat) || shape.prototype && shape.prototype.isTimestampFormatSet === true, false);\r\n  property(this, 'endpointDiscoveryId', Boolean(shape.endpointdiscoveryid), false);\r\n  property(this, 'hostLabel', Boolean(shape.hostLabel), false);\r\n\r\n  if (options.documentation) {\r\n    property(this, 'documentation', shape.documentation);\r\n    property(this, 'documentationUrl', shape.documentationUrl);\r\n  }\r\n\r\n  if (shape.xmlAttribute) {\r\n    property(this, 'isXmlAttribute', shape.xmlAttribute || false);\r\n  }\r\n\r\n  // type conversion and parsing\r\n  property(this, 'defaultValue', null);\r\n  this.toWireFormat = function(value) {\r\n    if (value === null || value === undefined) return '';\r\n    return value;\r\n  };\r\n  this.toType = function(value) { return value; };\r\n}\r\n\r\n/**\r\n * @api private\r\n */\r\nShape.normalizedTypes = {\r\n  character: 'string',\r\n  double: 'float',\r\n  long: 'integer',\r\n  short: 'integer',\r\n  biginteger: 'integer',\r\n  bigdecimal: 'float',\r\n  blob: 'binary'\r\n};\r\n\r\n/**\r\n * @api private\r\n */\r\nShape.types = {\r\n  'structure': StructureShape,\r\n  'list': ListShape,\r\n  'map': MapShape,\r\n  'boolean': BooleanShape,\r\n  'timestamp': TimestampShape,\r\n  'float': FloatShape,\r\n  'integer': IntegerShape,\r\n  'string': StringShape,\r\n  'base64': Base64Shape,\r\n  'binary': BinaryShape\r\n};\r\n\r\nShape.resolve = function resolve(shape, options) {\r\n  if (shape.shape) {\r\n    var refShape = options.api.shapes[shape.shape];\r\n    if (!refShape) {\r\n      throw new Error('Cannot find shape reference: ' + shape.shape);\r\n    }\r\n\r\n    return refShape;\r\n  } else {\r\n    return null;\r\n  }\r\n};\r\n\r\nShape.create = function create(shape, options, memberName) {\r\n  if (shape.isShape) return shape;\r\n\r\n  var refShape = Shape.resolve(shape, options);\r\n  if (refShape) {\r\n    var filteredKeys = Object.keys(shape);\r\n    if (!options.documentation) {\r\n      filteredKeys = filteredKeys.filter(function(name) {\r\n        return !name.match(/documentation/);\r\n      });\r\n    }\r\n\r\n    // create an inline shape with extra members\r\n    var InlineShape = function() {\r\n      refShape.constructor.call(this, shape, options, memberName);\r\n    };\r\n    InlineShape.prototype = refShape;\r\n    return new InlineShape();\r\n  } else {\r\n    // set type if not set\r\n    if (!shape.type) {\r\n      if (shape.members) shape.type = 'structure';\r\n      else if (shape.member) shape.type = 'list';\r\n      else if (shape.key) shape.type = 'map';\r\n      else shape.type = 'string';\r\n    }\r\n\r\n    // normalize types\r\n    var origType = shape.type;\r\n    if (Shape.normalizedTypes[shape.type]) {\r\n      shape.type = Shape.normalizedTypes[shape.type];\r\n    }\r\n\r\n    if (Shape.types[shape.type]) {\r\n      return new Shape.types[shape.type](shape, options, memberName);\r\n    } else {\r\n      throw new Error('Unrecognized shape type: ' + origType);\r\n    }\r\n  }\r\n};\r\n\r\nfunction CompositeShape(shape) {\r\n  Shape.apply(this, arguments);\r\n  property(this, 'isComposite', true);\r\n\r\n  if (shape.flattened) {\r\n    property(this, 'flattened', shape.flattened || false);\r\n  }\r\n}\r\n\r\nfunction StructureShape(shape, options) {\r\n  var self = this;\r\n  var requiredMap = null, firstInit = !this.isShape;\r\n\r\n  CompositeShape.apply(this, arguments);\r\n\r\n  if (firstInit) {\r\n    property(this, 'defaultValue', function() { return {}; });\r\n    property(this, 'members', {});\r\n    property(this, 'memberNames', []);\r\n    property(this, 'required', []);\r\n    property(this, 'isRequired', function() { return false; });\r\n  }\r\n\r\n  if (shape.members) {\r\n    property(this, 'members', new Collection(shape.members, options, function(name, member) {\r\n      return Shape.create(member, options, name);\r\n    }));\r\n    memoizedProperty(this, 'memberNames', function() {\r\n      return shape.xmlOrder || Object.keys(shape.members);\r\n    });\r\n\r\n    if (shape.event) {\r\n      memoizedProperty(this, 'eventPayloadMemberName', function() {\r\n        var members = self.members;\r\n        var memberNames = self.memberNames;\r\n        // iterate over members to find ones that are event payloads\r\n        for (var i = 0, iLen = memberNames.length; i < iLen; i++) {\r\n          if (members[memberNames[i]].isEventPayload) {\r\n            return memberNames[i];\r\n          }\r\n        }\r\n      });\r\n\r\n      memoizedProperty(this, 'eventHeaderMemberNames', function() {\r\n        var members = self.members;\r\n        var memberNames = self.memberNames;\r\n        var eventHeaderMemberNames = [];\r\n        // iterate over members to find ones that are event headers\r\n        for (var i = 0, iLen = memberNames.length; i < iLen; i++) {\r\n          if (members[memberNames[i]].isEventHeader) {\r\n            eventHeaderMemberNames.push(memberNames[i]);\r\n          }\r\n        }\r\n        return eventHeaderMemberNames;\r\n      });\r\n    }\r\n  }\r\n\r\n  if (shape.required) {\r\n    property(this, 'required', shape.required);\r\n    property(this, 'isRequired', function(name) {\r\n      if (!requiredMap) {\r\n        requiredMap = {};\r\n        for (var i = 0; i < shape.required.length; i++) {\r\n          requiredMap[shape.required[i]] = true;\r\n        }\r\n      }\r\n\r\n      return requiredMap[name];\r\n    }, false, true);\r\n  }\r\n\r\n  property(this, 'resultWrapper', shape.resultWrapper || null);\r\n\r\n  if (shape.payload) {\r\n    property(this, 'payload', shape.payload);\r\n  }\r\n\r\n  if (typeof shape.xmlNamespace === 'string') {\r\n    property(this, 'xmlNamespaceUri', shape.xmlNamespace);\r\n  } else if (typeof shape.xmlNamespace === 'object') {\r\n    property(this, 'xmlNamespacePrefix', shape.xmlNamespace.prefix);\r\n    property(this, 'xmlNamespaceUri', shape.xmlNamespace.uri);\r\n  }\r\n}\r\n\r\nfunction ListShape(shape, options) {\r\n  var self = this, firstInit = !this.isShape;\r\n  CompositeShape.apply(this, arguments);\r\n\r\n  if (firstInit) {\r\n    property(this, 'defaultValue', function() { return []; });\r\n  }\r\n\r\n  if (shape.member) {\r\n    memoizedProperty(this, 'member', function() {\r\n      return Shape.create(shape.member, options);\r\n    });\r\n  }\r\n\r\n  if (this.flattened) {\r\n    var oldName = this.name;\r\n    memoizedProperty(this, 'name', function() {\r\n      return self.member.name || oldName;\r\n    });\r\n  }\r\n}\r\n\r\nfunction MapShape(shape, options) {\r\n  var firstInit = !this.isShape;\r\n  CompositeShape.apply(this, arguments);\r\n\r\n  if (firstInit) {\r\n    property(this, 'defaultValue', function() { return {}; });\r\n    property(this, 'key', Shape.create({type: 'string'}, options));\r\n    property(this, 'value', Shape.create({type: 'string'}, options));\r\n  }\r\n\r\n  if (shape.key) {\r\n    memoizedProperty(this, 'key', function() {\r\n      return Shape.create(shape.key, options);\r\n    });\r\n  }\r\n  if (shape.value) {\r\n    memoizedProperty(this, 'value', function() {\r\n      return Shape.create(shape.value, options);\r\n    });\r\n  }\r\n}\r\n\r\nfunction TimestampShape(shape) {\r\n  var self = this;\r\n  Shape.apply(this, arguments);\r\n\r\n  if (shape.timestampFormat) {\r\n    property(this, 'timestampFormat', shape.timestampFormat);\r\n  } else if (self.isTimestampFormatSet && this.timestampFormat) {\r\n    property(this, 'timestampFormat', this.timestampFormat);\r\n  } else if (this.location === 'header') {\r\n    property(this, 'timestampFormat', 'rfc822');\r\n  } else if (this.location === 'querystring') {\r\n    property(this, 'timestampFormat', 'iso8601');\r\n  } else if (this.api) {\r\n    switch (this.api.protocol) {\r\n      case 'json':\r\n      case 'rest-json':\r\n        property(this, 'timestampFormat', 'unixTimestamp');\r\n        break;\r\n      case 'rest-xml':\r\n      case 'query':\r\n      case 'ec2':\r\n        property(this, 'timestampFormat', 'iso8601');\r\n        break;\r\n    }\r\n  }\r\n\r\n  this.toType = function(value) {\r\n    if (value === null || value === undefined) return null;\r\n    if (typeof value.toUTCString === 'function') return value;\r\n    return typeof value === 'string' || typeof value === 'number' ?\r\n           util.date.parseTimestamp(value) : null;\r\n  };\r\n\r\n  this.toWireFormat = function(value) {\r\n    return util.date.format(value, self.timestampFormat);\r\n  };\r\n}\r\n\r\nfunction StringShape() {\r\n  Shape.apply(this, arguments);\r\n\r\n  var nullLessProtocols = ['rest-xml', 'query', 'ec2'];\r\n  this.toType = function(value) {\r\n    value = this.api && nullLessProtocols.indexOf(this.api.protocol) > -1 ?\r\n      value || '' : value;\r\n    if (this.isJsonValue) {\r\n      return JSON.parse(value);\r\n    }\r\n\r\n    return value && typeof value.toString === 'function' ?\r\n      value.toString() : value;\r\n  };\r\n\r\n  this.toWireFormat = function(value) {\r\n    return this.isJsonValue ? JSON.stringify(value) : value;\r\n  };\r\n}\r\n\r\nfunction FloatShape() {\r\n  Shape.apply(this, arguments);\r\n\r\n  this.toType = function(value) {\r\n    if (value === null || value === undefined) return null;\r\n    return parseFloat(value);\r\n  };\r\n  this.toWireFormat = this.toType;\r\n}\r\n\r\nfunction IntegerShape() {\r\n  Shape.apply(this, arguments);\r\n\r\n  this.toType = function(value) {\r\n    if (value === null || value === undefined) return null;\r\n    return parseInt(value, 10);\r\n  };\r\n  this.toWireFormat = this.toType;\r\n}\r\n\r\nfunction BinaryShape() {\r\n  Shape.apply(this, arguments);\r\n  this.toType = function(value) {\r\n    var buf = util.base64.decode(value);\r\n    if (this.isSensitive && util.isNode() && typeof util.Buffer.alloc === 'function') {\r\n  /* Node.js can create a Buffer that is not isolated.\r\n   * i.e. buf.byteLength !== buf.buffer.byteLength\r\n   * This means that the sensitive data is accessible to anyone with access to buf.buffer.\r\n   * If this is the node shared Buffer, then other code within this process _could_ find this secret.\r\n   * Copy sensitive data to an isolated Buffer and zero the sensitive data.\r\n   * While this is safe to do here, copying this code somewhere else may produce unexpected results.\r\n   */\r\n      var secureBuf = util.Buffer.alloc(buf.length, buf);\r\n      buf.fill(0);\r\n      buf = secureBuf;\r\n    }\r\n    return buf;\r\n  };\r\n  this.toWireFormat = util.base64.encode;\r\n}\r\n\r\nfunction Base64Shape() {\r\n  BinaryShape.apply(this, arguments);\r\n}\r\n\r\nfunction BooleanShape() {\r\n  Shape.apply(this, arguments);\r\n\r\n  this.toType = function(value) {\r\n    if (typeof value === 'boolean') return value;\r\n    if (value === null || value === undefined) return null;\r\n    return value === 'true';\r\n  };\r\n}\r\n\r\n/**\r\n * @api private\r\n */\r\nShape.shapes = {\r\n  StructureShape: StructureShape,\r\n  ListShape: ListShape,\r\n  MapShape: MapShape,\r\n  StringShape: StringShape,\r\n  BooleanShape: BooleanShape,\r\n  Base64Shape: Base64Shape\r\n};\r\n\r\n/**\r\n * @api private\r\n */\r\nmodule.exports = Shape;\r\n"]},"metadata":{},"sourceType":"script"}